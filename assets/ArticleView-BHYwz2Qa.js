import{n as g,K as y,L as H,S as k,u as w,bR as U,bS as j,z as c,y as m,A as u,N as R,a5 as q,D as A,Q as v,R as D,an as b,aY as z,r as d,t as L,Z as G,M as K,i as N,V as Q,w as Y,bQ as Z}from"./vue-vendor-C6MpjvNb.js";import{a3 as S,ao as F,ap as M,aq as J,ar as W,as as X,at as x,au as ee,av as te,a4 as ae,aw as se}from"./vendor-GID0DrtC.js";import{_ as I}from"./main-CRQhYvNa.js";import{H as oe}from"./HeaderCom-CO0xque4.js";import"./element-plus-BkgncKVk.js";import"./markdown-vendor-KahlBxIV.js";const ne=g({__name:"MarkdownContent",props:{content:{}},setup(h){const t=h,e=[S,F,M,J,W],a=[X,x,ee,[te,{theme:"github-dark"}]],s={h1:{class:["markdown-header"]},h2:{class:["markdown-header"]},code:{class:["markdown-code"]},pre:{class:["markdown-pre"]}};return(l,o)=>(c(),y(j,null,{default:H(()=>[k(w(U),{markdown:t.content,"rehype-plugins":a,"remark-plugins":e,"custom-attrs":s},null,8,["markdown"])]),_:1}))}}),ce={class:"toc-item"},re=["href"],le={key:0,class:"toc-children"},ie=g({__name:"TocItemComponent",props:{item:{},activeId:{}},emits:["item-click"],setup(h){return(t,e)=>{const a=z("TocItemComponent",!0);return c(),m("li",ce,[u("a",{href:`#${t.item.id}`,class:A(["toc-link",`toc-level-${t.item.level}`,{"toc-active":t.activeId===t.item.id}]),onClick:e[0]||(e[0]=q(s=>t.$emit("item-click",t.item.id),["prevent"]))},v(t.item.title),11,re),t.item.children&&t.item.children.length>0?(c(),m("ul",le,[(c(!0),m(D,null,b(t.item.children,s=>(c(),y(a,{key:s.id,item:s,"active-id":t.activeId,onItemClick:e[1]||(e[1]=l=>t.$emit("item-click",l))},null,8,["item","active-id"]))),128))])):R("",!0)])}}}),de=I(ie,[["__scopeId","data-v-cd08a658"]]),ue={class:"toc-container"},me={class:"toc-header"},he={class:"collapse-icon"},pe={class:"toc-nav"},ve={class:"toc-list"},_e=g({__name:"TocContainer",props:{tocItems:{}},setup(h){const t=N("syslang"),e=d(""),a=d(!1),s=()=>{a.value=!a.value},l=n=>{const r=document.getElementById(n);r&&r.scrollIntoView({behavior:"smooth"})},o=()=>{const n=document.querySelectorAll("h1, h2, h3, h4, h5, h6");let r="";for(const i of n)i.getBoundingClientRect().top<=100&&(r=i.id);e.value=r};return L(()=>{window.addEventListener("scroll",o),o()}),G(()=>{window.removeEventListener("scroll",o)}),(n,r)=>(c(),m("div",ue,[u("div",me,[u("div",{class:"toc-header-content",onClick:s},[u("h3",null,v(w(t).TOC_MENU),1),u("button",{class:A(["collapse-btn",{collapsed:a.value}])},[u("span",he,v(a.value?"▶":"▼"),1)],2)])]),K(u("nav",pe,[u("ul",ve,[(c(!0),m(D,null,b(n.tocItems,i=>(c(),y(de,{key:i.id,item:i,"active-id":e.value,onItemClick:l},null,8,["item","active-id"]))),128))])],512),[[Q,!a.value]])]))}}),fe=I(_e,[["__scopeId","data-v-6ac799cc"]]);function ke(h){const e=ae().use(S).use(M).use(F,["yaml","toml"]).parse(h),a=[],s=new se;function l(o){if(o.type==="heading"){const n=o,r=n.children.map(i=>i.value||"").join("").trim();if(r){const i=s.slug(r);a.push({id:i,title:r,level:n.depth})}}"children"in o&&Array.isArray(o.children)&&o.children.forEach(l)}return l(e),ge(a)}function ge(h){const t=[],e=[];for(const a of h){for(;e.length>0&&e[e.length-1].level>=a.level;)e.pop();if(e.length===0)t.push(a);else{const s=e[e.length-1];s.children||(s.children=[]),s.children.push(a)}e.push(a)}return t}const ye={class:"article-page"},we={key:0,class:"loading"},Ie={key:1,class:"error"},Ce={key:2,class:"article-content"},$e={class:"article-layout"},Ee={class:"article-main"},Te={key:0,class:"floating-toc"},Re=g({__name:"ArticleView",setup(h){const t=N("syslang"),e=Z(),a=d(!0),s=d(""),l=d(""),o=d(""),n=d(""),r=d([]),i=d(""),_=d([]),C=async()=>{try{a.value=!0,s.value="";const p=e.meta?.articlePath||e.params.path;if(!p)throw new Error(t.ERROR_FILE_NOT_FOUND);const f=await fetch(`/articles/${p}`);if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);if(l.value=await f.text(),_.value=ke(l.value),e.meta?.title&&(o.value=e.meta.title),e.meta?.date&&(n.value=t.formatDateTime(e.meta.date)),e.meta?.keywords&&(r.value=e.meta.keywords),e.meta?.abstract&&(i.value=e.meta.abstract),!o.value||!n.value){const $=p.split("/"),E=$[$.length-1],T=E.match(/(\d{4})-(\d{2})-(\d{2})-(.+)\.md$/);if(T){const[,V,B,O,P]=T;o.value||(o.value=P.replace(/-/g," ")),n.value||(n.value=t.formatDate(V,B,O))}else o.value||(o.value=E.replace(/\.md$/,""))}}catch(p){s.value=t.ERROR_FILE_READ_FAILED,console.error(t.ERROR_FILE_READ_FAILED,p)}finally{a.value=!1}};return L(()=>{C()}),Y(()=>e.params.path,C),(p,f)=>(c(),m("div",ye,[a.value?(c(),m("div",we,v(w(t).HINT_LOADING),1)):s.value?(c(),m("div",Ie,v(s.value),1)):(c(),m("div",Ce,[u("div",$e,[u("div",Ee,[k(oe,{title:o.value,desc:n.value},null,8,["title","desc"]),k(ne,{content:l.value},null,8,["content"])])]),_.value.length>0?(c(),m("div",Te,[k(fe,{"toc-items":_.value},null,8,["toc-items"])])):R("",!0)]))]))}}),Fe=I(Re,[["__scopeId","data-v-0d2a2181"]]);export{Fe as default};
